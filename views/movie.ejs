<link rel="stylesheet" href="/styles/style.css">

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark shadow">
  <div class="container fluid">
    <a class="navbar-brand" href="#">RANARA CINEMA</a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
      aria-controls="navbarNav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/login">Login</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/signup">Signup</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!--Carousel section-->
<div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="/images/carousel1.jpg" class="d-block w-100" alt="cr1">
    </div>
    <div class="carousel-item">
      <img src="/images/carousel2.jpg" class="d-block w-100" alt="cr2">
    </div>
    <div class="carousel-item">
      <img src="/images/carousel3.jpg" class="d-block w-100" alt="cr3">
    </div>
    <div class="carousel-item">
      <img src="/images/carousel4.jpg" class="d-block w-100" alt="cr4">
    </div>
    <div class="carousel-item">
      <img src="/images/carousel5.jpg" class="d-block w-100" alt="cr5">
    </div>
    <div class="carousel-item">
      <img src="/images/carousel6.jpg" class="d-block w-100" alt="cr6">
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>

<!-- Main Content -->
<div class="container mt-5">
  <h1 class="text-center mb-4 text-dark">Sedang Tayang</h1>
  <div class="row">
    <% films.forEach((film) => { %>
    <div class="col-md-4 mb-4">
      <div class="card-container">
        <img
          src="<%= film.image_url || '/default-image.jpg' %>"
          class="card-img-top"
          alt="<%= film.title %>"
        />
        <div class="card-body">
          <h5 class="card-title text-primary"><%= film.title %></h5>
          <p class="card-text text-truncate" style="max-height: 3.6em">
            <%= film.description %>
          </p>
          <button
            class="btn btn-link p-0 text-primary"
            onclick="showSynopsis('<%= film.id_film %>')"
          >
            Lihat Sinopsis
          </button>
        </div>
        <div class="card-footer text-center">
          <a class="btn btn-primary" href="/login">Order</a>
        </div>
      </div>
    </div>
    <% }); %>
  </div>
</div>

<!-- Bootstrap Modal -->
<div
  class="modal fade"
  id="synopsisModal"
  tabindex="-1"
  aria-labelledby="synopsisModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-primary text-light">
        <h5 class="modal-title" id="synopsisModalLabel">Sinopsis Film</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" id="synopsisContent"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Tutup
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  function showSynopsis(id) {
    fetch(`/films/${id}`) 
      .then((response) => response.json())
      .then((data) => {
        document.getElementById("synopsisContent").innerText = data.description;
        new bootstrap.Modal(document.getElementById("synopsisModal")).show();
      })
      .catch((error) => console.error("Error fetching synopsis:", error));
  }
</script>
